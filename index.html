
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emergency Entities Portal</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .slide-up { animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // Emergency Entity Detail Component
        const EmergencyEntityDetail = ({ entity, onClose, onEdit }) => {
            const formatPhoneNumbers = (phones) => {
                if (!phones) return [];
                return Array.isArray(phones) ? phones : (typeof phones === 'string' ? JSON.parse(phones) : []);
            };

            const formatJSON = (data) => {
                if (!data) return null;
                return typeof data === 'string' ? JSON.parse(data) : data;
            };

            const getTypeIcon = (type) => {
                const icons = {
                    '911_center': 'fas fa-phone-alt text-red-600',
                    'hospital': 'fas fa-hospital text-blue-600',
                    'ems_station': 'fas fa-ambulance text-green-600',
                    'fire_department': 'fas fa-fire-extinguisher text-orange-600',
                    'police_department': 'fas fa-shield-alt text-indigo-600',
                    'other': 'fas fa-building text-gray-600'
                };
                return icons[type] || icons.other;
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
                    <div className="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto slide-up">
                        <div className="p-6">
                            <div className="flex justify-between items-start mb-4">
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-900">{entity.name}</h2>
                                    <span className={`inline-block px-2 py-1 text-xs font-semibold rounded-full mt-2 ${
                                        entity.type === '911_center' ? 'bg-red-100 text-red-800' :
                                        entity.type === 'hospital' ? 'bg-blue-100 text-blue-800' :
                                        entity.type === 'ems_station' ? 'bg-green-100 text-green-800' :
                                        entity.type === 'fire_department' ? 'bg-orange-100 text-orange-800' :
                                        'bg-gray-100 text-gray-800'
                                    }`}>
                                        {entity.type.replace('_', ' ').toUpperCase()}
                                    </span>
                                </div>
                                <button onClick={onClose} className="text-gray-400 hover:text-gray-600">
                                    <i className="fas fa-times text-xl"></i>
                                </button>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <h3 className="text-lg font-semibold mb-3 text-gray-900 border-b pb-2">
                                        <i className="fas fa-info-circle mr-2"></i>Contact Information
                                    </h3>
                                    
                                    {entity.address && (
                                        <div className="mb-4">
                                            <span className="font-medium text-gray-700 flex items-center">
                                                <i className="fas fa-map-marker-alt mr-2 text-gray-500"></i>
                                                Address:
                                            </span>
                                            <p className="text-gray-600 ml-6">{entity.address}</p>
                                        </div>
                                    )}
                                    
                                    {entity.phone_numbers && formatPhoneNumbers(entity.phone_numbers).length > 0 && (
                                        <div className="mb-4">
                                            <span className="font-medium text-gray-700 flex items-center">
                                                <i className="fas fa-phone mr-2 text-gray-500"></i>
                                                Phone Numbers:
                                            </span>
                                            <div className="ml-6 space-y-1">
                                                {formatPhoneNumbers(entity.phone_numbers).map((phone, idx) => (
                                                    <div key={idx} className="flex items-center space-x-2">
                                                        <span className="text-sm font-medium text-gray-600">{phone.label}:</span>
                                                        <a href={`tel:${phone.number}`} className="text-blue-600 hover:underline">
                                                            {phone.number}
                                                        </a>
                                                    </div>
                                                ))}
                                            </div>
                                        </div>
                                    )}

                                    {entity.contracted_service && (
                                        <div className="mb-4">
                                            <h4 className="font-semibold text-gray-900 flex items-center">
                                                <i className="fas fa-handshake mr-2 text-gray-500"></i>
                                                Contracted Service
                                            </h4>
                                            <p className="text-gray-600 ml-6">{entity.contracted_service}</p>
                                        </div>
                                    )}

                                    {entity.er_entrance && (
                                        <div className="mb-4">
                                            <h4 className="font-semibold text-gray-900 flex items-center">
                                                <i className="fas fa-door-open mr-2 text-gray-500"></i>
                                                ER Entrance
                                            </h4>
                                            <p className="text-gray-600 ml-6">{entity.er_entrance}</p>
                                        </div>
                                    )}
                                </div>

                                <div>
                                    <h3 className="text-lg font-semibold mb-3 text-gray-900 border-b pb-2">
                                        <i className="fas fa-cogs mr-2"></i>Program Details
                                    </h3>
                                    
                                    {entity.flight_program && formatJSON(entity.flight_program) && (
                                        <div className="mb-4">
                                            <h4 className="font-semibold text-gray-900 flex items-center">
                                                <i className="fas fa-helicopter mr-2 text-gray-500"></i>
                                                Flight Program
                                            </h4>
                                            <div className="text-sm text-gray-600 ml-6 space-y-1">
                                                <p>Participating: {formatJSON(entity.flight_program).participating ? 'Yes' : 'No'}</p>
                                                <p>One Call: {formatJSON(entity.flight_program).isOneCall ? 'Yes' : 'No'}</p>
                                                {formatJSON(entity.flight_program).notes && (
                                                    <p>Notes: {formatJSON(entity.flight_program).notes}</p>
                                                )}
                                                {formatJSON(entity.flight_program).landingZones && formatJSON(entity.flight_program).landingZones.length > 0 && (
                                                    <p>Landing Zones: {formatJSON(entity.flight_program).landingZones.join(', ')}</p>
                                                )}
                                            </div>
                                        </div>
                                    )}

                                    {entity.county_info && formatJSON(entity.county_info) && (
                                        <div className="mb-4">
                                            <h4 className="font-semibold text-gray-900 flex items-center">
                                                <i className="fas fa-map mr-2 text-gray-500"></i>
                                                County Information
                                            </h4>
                                            <div className="text-sm text-gray-600 ml-6 space-y-1">
                                                <p>County: {formatJSON(entity.county_info).county}</p>
                                                {formatJSON(entity.county_info).emsAgencies && formatJSON(entity.county_info).emsAgencies.length > 0 && (
                                                    <p>EMS Agencies: {formatJSON(entity.county_info).emsAgencies.join(', ')}</p>
                                                )}
                                                {formatJSON(entity.county_info).fireAgencies && formatJSON(entity.county_info).fireAgencies.length > 0 && (
                                                    <p>Fire Agencies: {formatJSON(entity.county_info).fireAgencies.join(', ')}</p>
                                                )}
                                                {formatJSON(entity.county_info).sheriffAgencies && formatJSON(entity.county_info).sheriffAgencies.length > 0 && (
                                                    <div>
                                                        <p>Sheriff Agencies:</p>
                                                        {formatJSON(entity.county_info).sheriffAgencies.map((agency, idx) => (
                                                            <div key={idx} className="ml-4">
                                                                <p>- {agency.name}: {agency.phone}</p>
                                                                {agency.description && <p className="text-xs italic">{agency.description}</p>}
                                                            </div>
                                                        ))}
                                                    </div>
                                                )}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>

                            {entity.notes && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-gray-900 flex items-center">
                                        <i className="fas fa-sticky-note mr-2 text-gray-500"></i>
                                        Notes
                                    </h4>
                                    <p className="text-gray-600 bg-gray-50 p-3 rounded">{entity.notes}</p>
                                </div>
                            )}

                            {entity.last_contact && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-gray-900 flex items-center">
                                        <i className="fas fa-calendar mr-2 text-gray-500"></i>
                                        Last Contact
                                    </h4>
                                    <p className="text-gray-600">{new Date(entity.last_contact).toLocaleDateString()}</p>
                                </div>
                            )}

                            <div className="flex justify-end space-x-2 mt-6 pt-4 border-t">
                                <button
                                    onClick={() => onEdit(entity)}
                                    className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center"
                                >
                                    <i className="fas fa-edit mr-2"></i>Edit
                                </button>
                                <button
                                    onClick={onClose}
                                    className="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Emergency Entity Form Component
        const EmergencyEntityForm = ({ entity, onSave, onCancel }) => {
            const [formData, setFormData] = useState({
                name: entity?.name || '',
                type: entity?.type || '911_center',
                address: entity?.address || '',
                phone_numbers: entity?.phone_numbers || [],
                contracted_service: entity?.contracted_service || '',
                contractual_obligations: entity?.contractual_obligations || [],
                er_entrance: entity?.er_entrance || '',
                flight_program: entity?.flight_program || {
                    notes: '',
                    isOneCall: false,
                    landingZones: [],
                    participating: false,
                    flightByGround: false
                },
                backup_services: entity?.backup_services || {
                    mutualAid: '',
                    airServices: [],
                    groundServices: [],
                    noUnitsContact: ''
                },
                county_info: entity?.county_info || {
                    county: '',
                    emsAgencies: [],
                    fireAgencies: [],
                    sheriffAgencies: []
                },
                notes: entity?.notes || '',
                last_contact: entity?.last_contact || ''
            });

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            const addPhoneNumber = () => {
                setFormData(prev => ({
                    ...prev,
                    phone_numbers: [...prev.phone_numbers, { label: '', number: '' }]
                }));
            };

            const removePhoneNumber = (index) => {
                setFormData(prev => ({
                    ...prev,
                    phone_numbers: prev.phone_numbers.filter((_, i) => i !== index)
                }));
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 fade-in">
                    <div className="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto slide-up">
                        <div className="p-6">
                            <h2 className="text-2xl font-bold mb-4">
                                {entity ? 'Edit Emergency Entity' : 'Add New Emergency Entity'}
                            </h2>
                            <form onSubmit={handleSubmit} className="space-y-4">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">Entity Name *</label>
                                        <input
                                            type="text"
                                            value={formData.name}
                                            onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}
                                            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                            required
                                            placeholder="e.g., Columbus City 911"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">Entity Type *</label>
                                        <select
                                            value={formData.type}
                                            onChange={(e) => setFormData(prev => ({ ...prev, type: e.target.value }))}
                                            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                        >
                                            <option value="911_center">911 Center</option>
                                            <option value="hospital">Hospital</option>
                                            <option value="ems_station">EMS Station</option>
                                            <option value="fire_department">Fire Department</option>
                                            <option value="police_department">Police Department</option>
                                            <option value="other">Other</option>
                                        </select>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Address</label>
                                    <textarea
                                        value={formData.address}
                                        onChange={(e) => setFormData(prev => ({ ...prev, address: e.target.value }))}
                                        className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                        rows={2}
                                        placeholder="Complete address with city, state, zip"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Phone Numbers</label>
                                    {formData.phone_numbers.map((phone, idx) => (
                                        <div key={idx} className="flex items-center space-x-2 mb-2">
                                            <input
                                                type="text"
                                                placeholder="Label (e.g., Main, ER, Dispatch)"
                                                value={phone.label}
                                                onChange={(e) => {
                                                    const newPhones = [...formData.phone_numbers];
                                                    newPhones[idx].label = e.target.value;
                                                    setFormData(prev => ({ ...prev, phone_numbers: newPhones }));
                                                }}
                                                className="flex-1 rounded-md border-gray-300"
                                            />
                                            <input
                                                type="tel"
                                                placeholder="(XXX) XXX-XXXX"
                                                value={phone.number}
                                                onChange={(e) => {
                                                    const newPhones = [...formData.phone_numbers];
                                                    newPhones[idx].number = e.target.value;
                                                    setFormData(prev => ({ ...prev, phone_numbers: newPhones }));
                                                }}
                                                className="flex-1 rounded-md border-gray-300"
                                            />
                                            <button
                                                type="button"
                                                onClick={() => removePhoneNumber(idx)}
                                                className="text-red-600 hover:text-red-800"
                                            >
                                                <i className="fas fa-times"></i>
                                            </button>
                                        </div>
                                    ))}
                                    <button
                                        type="button"
                                        onClick={addPhoneNumber}
                                        className="text-sm text-blue-600 hover:text-blue-800 flex items-center"
                                    >
                                        <i className="fas fa-plus mr-1"></i>Add Phone Number
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">Contracted Service</label>
                                        <textarea
                                            value={formData.contracted_service}
                                            onChange={(e) => setFormData(prev => ({ ...prev, contracted_service: e.target.value }))}
                                            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                            rows={2}
                                            placeholder="Description of contracted services"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700">ER Entrance</label>
                                        <input
                                            type="text"
                                            value={formData.er_entrance}
                                            onChange={(e) => setFormData(prev => ({ ...prev, er_entrance: e.target.value }))}
                                            className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                            placeholder="ER entrance details"
                                        />
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Notes</label>
                                    <textarea
                                        value={formData.notes}
                                        onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}
                                        className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                        rows={3}
                                        placeholder="Additional notes or special instructions"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Last Contact Date</label>
                                    <input
                                        type="date"
                                        value={formData.last_contact}
                                        onChange={(e) => setFormData(prev => ({ ...prev, last_contact: e.target.value }))}
                                        className="mt-1 block w-full rounded-md border-gray-300 shadow-sm"
                                    />
                                </div>

                                <div className="flex justify-end space-x-2 pt-4 border-t">
                                    <button
                                        type="button"
                                        onClick={onCancel}
                                        className="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                                    >
                                        {entity ? 'Update Entity' : 'Create Entity'}
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };

        // Main App Component
        const EmergencyEntitiesApp = () => {
            const [entities, setEntities] = useState([]);
            const [filteredEntities, setFilteredEntities] = useState([]);
            const [selectedEntity, setSelectedEntity] = useState(null);
            const [showForm, setShowForm] = useState(false);
            const [editingEntity, setEditingEntity] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');
            const [typeFilter, setTypeFilter] = useState('all');

            // Sample data based on your exact structure
            const sampleData = [
                {
                    id: 6,
                    name: "Columbus City 911",
                    type: "911_center",
                    address: "510 E 10th St, Columbus, GA 31901",
                    phone_numbers: [{"label": "Main", "number": "(706) 653-3221"}],
                    contracted_service: "",
                    contractual_obligations: [],
                    er_entrance: "",
                    flight_program: {
                        notes: "",
                        isOneCall: false,
                        landingZones: [],
                        participating: false,
                        flightByGround: false
                    },
                    backup_services: {
                        mutualAid: "",
                        airServices: [],
                        groundServices: [],
                        noUnitsContact: ""
                    },
                    county_info: {
                        county: "Muscogee County, GA",
                        emsAgencies: [],
                        fireAgencies: [],
                        sheriffAgencies: [{
                            name: "Muscogee County Sheriff's Office",
                            phone: "(706) 653-4225",
                            description: ""
                        }]
                    },
                    notes: "",
                    last_contact: "2025-09-04",
                    created_at: "2025-09-04 02:42:43.192837",
                    updated_at: "2025-09-04 02:42:43.192837"
                },
                {
                    id: 7,
                    name: "Piedmont Columbus Regional",
                    type: "hospital",
                    address: "710 Center St, Columbus, GA 31901",
                    phone_numbers: [
                        {"label": "Main", "number": "(706) 571-1000"},
                        {"label": "ER", "number": "(706) 571-1200"}
                    ],
                    contracted_service: "Full service emergency care",
                    flight_program: {
                        notes: "Level 1 Trauma Center",
                        isOneCall: true,
                        landingZones: ["Main Pad", "South Pad"],
                        participating: true,
                        flightByGround: true
                    },
                    county_info: {
                        county: "Muscogee County, GA",
                        emsAgencies: ["Muscogee County EMS"],
                        fireAgencies: ["Columbus Fire Department"],
                        sheriffAgencies: [{
                            name: "Muscogee County Sheriff",
                            phone: "(706) 653-4225",
                            description: "County law enforcement"
                        }]
                    },
                    last_contact: "2025-09-03"
                },
                {
                    id: 8,
                    name: "Muscogee County EMS Station 1",
                    type: "ems_station",
                    address: "210 10th St, Columbus, GA 31901",
                    phone_numbers: [
                        {"label": "Station", "number": "(706) 653-3370"},
                        {"label": "Dispatch", "number": "(706) 653-3221"}
                    ],
                    contracted_service: "911 emergency response",
                    backup_services: {
                        mutualAid: "Regional EMS mutual aid",
                        airServices: ["AirEvac", "LifeFlight"],
                        groundServices: ["Regional Ambulance", "Mutual Aid EMS"],
                        noUnitsContact: "911 Dispatch"
                    },
                    last_contact: "2025-09-02"
                },
                {
                    id: 9,
                    name: "Columbus Fire Department Station 1",
                    type: "fire_department",
                    address: "510 E 10th St, Columbus, GA 31901",
                    phone_numbers: [
                        {"label": "Station", "number": "(706) 653-3200"},
                        {"label": "Non-Emergency", "number": "(706) 653-3205"}
                    ],
                    contracted_service: "Fire suppression and rescue",
                    backup_services: {
                        mutualAid: "Automatic aid agreements",
                        airServices: ["Regional air support"],
                        groundServices: ["Regional fire departments"],
                        noUnitsContact: "911 Dispatch"
                    },
                    last_contact: "2025-09-01"
                }
            ];

            useEffect(() => {
                // Load sample data for demonstration
                // Replace with actual database connection
                setEntities(sampleData);
                setFilteredEntities(sampleData);
            }, []);

            useEffect(() => {
                let filtered = entities;
                
                if (searchTerm) {
                    filtered = filtered.filter(entity => 
                        entity.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        entity.address?.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        entity.contracted_service?.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                }
                
                if (typeFilter !== 'all') {
                    filtered = filtered.filter(entity => entity.type === typeFilter);
                }
                
                setFilteredEntities(filtered);
            }, [searchTerm, typeFilter, entities]);

            const handleSave = (entityData) => {
                // This would typically connect to your database
                // For now, we'll update the local state
                if (editingEntity) {
                    setEntities(prev => prev.map(e => 
                        e.id === editingEntity.id ? { ...e, ...entityData, updated_at: new Date().toISOString() } : e
                    ));
                } else {
                    const newEntity = {
                        ...entityData,
                        id: Math.max(...entities.map(e => e.id || 0)) + 1,
                        created_at: new Date().toISOString(),
                        updated_at: new Date().toISOString()
                    };
                    setEntities(prev => [...prev, newEntity]);
                }
                setShowForm(false);
                setEditingEntity(null);
            };

            const handleEdit = (entity) => {
                setEditingEntity(entity);
                setShowForm(true);
            };

            const handleDelete = async (id) => {
                if (window.confirm('Are you sure you want to delete this entity?')) {
                    // This would typically make an API call to delete
                    setEntities(prev => prev.filter(e => e.id !== id));
                }
            };

            const getTypeIcon = (type) => {
                const icons = {
                    '911_center': 'fas fa-phone-alt text-red-600',
                    'hospital': 'fas fa-hospital text-blue-600',
                    'ems_station': 'fas fa-ambulance text-green-600',
                    'fire_department': 'fas fa-fire-extinguisher text-orange-600',
                    'police_department': 'fas fa-shield-alt text-indigo-600',
                    'other': 'fas fa-building text-gray-600'
                };
                return icons[type] || icons.other;
            };

            const getTypeColor = (type) => {
                const colors = {
                    '911_center': 'bg-red-100 text-red-800',
                    'hospital': 'bg-blue-100 text-blue-800',
                    'ems_station': 'bg-green-100 text-green-800',
                    'fire_department': 'bg-orange-100 text-orange-800',
                    'police_department': 'bg-indigo-100 text-indigo-800',
                    'other': 'bg-gray-100 text-gray-800'
                };
                return colors[type] || colors.other;
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <div className="bg-white shadow">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex justify-between items-center py-6">
                                <div>
                                    <h1 className="text-3xl font-bold text-gray-900">Emergency Entities Portal</h1>
                                    <p className="text-sm text-gray-600 mt-1">Comprehensive management for emergency service entities</p>
                                </div>
                                <button
                                    onClick={() => setShowForm(true)}
                                    className="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 flex items-center"
                                >
                                    <i className="fas fa-plus mr-2"></i>Add Entity
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Search and Filter */}
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        <div className="bg-white rounded-lg shadow mb-6 p-4">
                            <div className="flex flex-col sm:flex-row gap-4">
                                <div className="flex-1">
                                    <div className="relative">
                                        <input
                                            type="text"
                                            placeholder="Search by name, address, or service..."
                                            value={searchTerm}
                                            onChange={(e) => setSearchTerm(e.target.value)}
                                            className="w-full rounded-md border-gray-300 shadow-sm pl-10"
                                        />
                                        <i className="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                                    </div>
                                </div>
                                <div className="flex gap-2">
                                    <select
                                        value={typeFilter}
                                        onChange={(e) => setTypeFilter(e.target.value)}
                                        className="rounded-md border-gray-300 shadow-sm"
                                    >
                                        <option value="all">All Types</option>
                                        <option value="911_center">911 Centers</option>
                                        <option value="hospital">Hospitals</option>
                                        <option value="ems_station">EMS Stations</option>
                                        <option value="fire_department">Fire Departments</option>
                                        <option value="police_department">Police Departments</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        {/* Results Summary */}
                        <div className="mb-4">
                            <p className="text-sm text-gray-600">
                                Showing {filteredEntities.length} of {entities.length} entities
                                {searchTerm && ` for "${searchTerm}"`}
                                {typeFilter !== 'all' && ` filtered by ${typeFilter.replace('_', ' ')}`}
                            </p>
                        </div>

                        {/* Entity Grid */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {filteredEntities.map(entity => (
                                <div key={entity.id} className="bg-white rounded-lg shadow hover:shadow-lg transition-shadow">
                                    <div className="p-6">
                                        <div className="flex items-start justify-between mb-4">
                                            <div className="flex-1">
                                                <h3 className="text-lg font-semibold text-gray-900">{entity.name}</h3>
                                                <div className="flex items-center mt-1">
                                                    <i className={`${getTypeIcon(entity.type)} mr-2 text-lg`}></i>
                                                    <span className={`inline-block px-2 py-1 text-xs font-semibold rounded-full ${getTypeColor(entity.type)} capitalize`}>
                                                        {entity.type.replace('_', ' ')}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        {entity.address && (
                                            <p className="text-sm text-gray-600 mb-2 flex items-start">
                                                <i className="fas fa-map-marker-alt mr-2 mt-1 text-gray-400"></i>
                                                <span>{entity.address}</span>
                                            </p>
                                        )}
                                        
                                        {entity.phone_numbers && entity.phone_numbers.length > 0 && (
                                            <p className="text-sm text-gray-600 mb-2 flex items-start">
                                                <i className="fas fa-phone mr-2 mt-1 text-gray-400"></i>
                                                <span>{entity.phone_numbers[0].number}</span>
                                            </p>
                                        )}

                                        {entity.last_contact && (
                                            <p className="text-xs text-gray-500 mb-4">
                                                <i className="fas fa-calendar mr-1"></i>
                                                Last contact: {new Date(entity.last_contact).toLocaleDateString()}
                                            </p>
                                        )}

                                        <div className="flex space-x-2 pt-4 border-t">
                                            <button
                                                onClick={() => setSelectedEntity(entity)}
                                                className="flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 flex items-center justify-center"
                                            >
                                                <i className="fas fa-eye mr-1"></i>View
                                            </button>
                                            <button
                                                onClick={() => handleEdit(entity)}
                                                className="flex-1 bg-gray-600 text-white px-3 py-2 rounded text-sm hover:bg-gray-700 flex items-center justify-center"
                                            >
                                                <i className="fas fa-edit mr-1"></i>Edit
                                            </button>
                                            <button
                                                onClick={() => handleDelete(entity.id)}
                                                className="flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 flex items-center justify-center"
                                            >
                                                <i className="fas fa-trash mr-1"></i>Delete
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>

                        {filteredEntities.length === 0 && (
                            <div className="text-center py-12">
                                <i className="fas fa-search text-4xl text-gray-400 mb-4"></i>
                                <p className="text-gray-600">No emergency entities found</p>
                                {searchTerm && (
                                    <p className="text-sm text-gray-500 mt-2">
                                        Try adjusting your search terms or filters
                                    </p>
                                )}
                            </div>
                        )}
                    </div>

                    {/* Modals */}
                    {selectedEntity && (
                        <EmergencyEntityDetail
                            entity={selectedEntity}
                            onClose={() => setSelectedEntity(null)}
                            onEdit={handleEdit}
                        />
                    )}

                    {showForm && (
                        <EmergencyEntityForm
                            entity={editingEntity}
                            onSave={handleSave}
                            onCancel={() => {
                                setShowForm(false);
                                setEditingEntity(null);
                            }}
                        />
                    )}
                </div>
            );
        };

        // Initialize the app
        ReactDOM.render(<EmergencyEntitiesApp />, document.getElementById('root'));
    </script>
</body>
</html>
